---
title: "phylo"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, message=FALSE}
library(taxPPro)
library(bugphyzz)
library(purrr)
library(dplyr)
```


# Get metaphlan tree

```{r, message=FALSE}
tree <- getMpaTree()
tree
```

# Import bugphyzz physiologies

```{r, message=FALSE}
phys <- physiologies('all', remove_false = TRUE, full_source = FALSE)
```

# Get as many species level taxids as possible

```{r}
no_propagation <- phys |> 
    map_dbl(~ {
        df <- .x[!is.na(.x$NCBI_ID),]
        mean(df$NCBI_ID %in% tree$tip.label) * 100
    }) |> 
    as.data.frame() |> 
    tibble::rownames_to_column(var = 'spreadsheet') |> 
    magrittr::set_colnames(c('spreadsheet', 'percent')) |> 
    arrange(-percent)
no_propagation
```

